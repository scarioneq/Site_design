{% extends 'base.html' %}

{% block content %}
<h1>Изменение статуса заявки</h1>

<h2>"{{ application.title }}"</h2>
<p>Пользователь: {{ application.user.full_name }}</p>
<p>Текущий статус: <strong>{{ application.get_status_display }}</strong></p>

{% if application.status == 'new' %}
    <p><strong>Принять заявку в работу</strong></p>
    <p><em>Комментарий обязателен</em></p>
{% else %}
    <p><strong>Завершить заявку</strong></p>
    <p><em>Изображение дизайна обязательно</em></p>
{% endif %}

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    
    {% for field in form %}
        <div>
            {{ field.label_tag }}
            {{ field }}
            {% if field.errors %}
                <div style="color: red;">
                    {% for error in field.errors %}
                        {{ error }}
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    {% endfor %}

    <button type="submit">
        {% if application.status == 'new' %}
            Принять в работу
        {% else %}
            Завершить заявку
        {% endif %}
    </button>
    <a href="{% url 'admin_dashboard' %}">Отмена</a>
</form>
{% endblock %}